



---
title: "GoM cod and haddock RDM"
author: "Lou Carr-Harris"
date: "`r Sys.Date()`"
output: 
  html_document:
    theme: cerulean
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(comment = NA)
cat('<pre>')
pkgs_to_use <- c("tidyr",  "magrittr", "tidyverse", "reshape2","splitstackshape",
                 "doBy","WriteXLS","Rcpp", "ggplot2","dplyr", "rlist","fitdistrplus",
                 "MASS",  "psych", "rgl","copula", "VineCopula","scales","univariateML",
                 "logspline","readr","data.table","conflicted", "readxl", "writexl", "stringr",
                 "plyr" , "furrr", "profvis", "future", "Hmisc", "tictoc", "sjPlot", "gridExtra", 
                 "rmdformats", "prettydoc", "hrbrthemes", "tint", "tufte")
install.packages(setdiff(pkgs_to_use, rownames(installed.packages())))  
lapply(pkgs_to_use, library, character.only = TRUE, quietly = TRUE)
conflict_prefer("filter", "dplyr")
conflict_prefer("select", "dplyr")
conflict_prefer("mutate", "dplyr")
conflict_prefer("rename", "dplyr")
conflict_prefer("summarize", "dplyr")
conflict_prefer("summarise", "dplyr")
conflict_prefer("count", "dplyr")
```
This file is an exploratory analysis of the effect of climate-induced shifts in angler catch-per-trip of Gulf of Maine cod and haddock. Results are based on 100 iterations of the recreation demand model. The RDM is calibrated to 2020 fishery conditions.   

### Baseline (2020) fishery statistics
Index "_i" indicates per choice occasion variable 

```{r echo = FALSE}
calib_data <- readRDS("calibration_data_all.rds")
calib_data<-calib_data %>% 
  dplyr::group_by(draw) %>% 
  dplyr::summarise(estimated_trips=sum(estimated_trips),
                   n_choice_occasions = sum(n_choice_occasions),
                   tot_cod_catch= sum(tot_cod_catch), 
                   tot_keep_cod = sum(tot_keep_cod), 
                   tot_rel_cod = sum(tot_rel_cod), 
                   
                   tot_hadd_catch = sum(tot_hadd_catch), 
                   tot_keep_hadd = sum(tot_keep_hadd),
                   tot_rel_hadd = sum(tot_rel_hadd)) %>% 
  
  dplyr::mutate(cod_keep_i=tot_keep_cod/n_choice_occasions, 
                hadd_keep_i=tot_keep_hadd/n_choice_occasions,
                cod_keep_trip=tot_keep_cod/estimated_trips, 
                hadd_keep_trip=tot_keep_hadd/estimated_trips, 
                cod_catch_i=tot_cod_catch/n_choice_occasions, 
                hadd_catch_i=tot_hadd_catch/n_choice_occasions, 
                cod_catch_trip=tot_cod_catch/estimated_trips, 
                hadd_catch_trip=tot_hadd_catch/estimated_trips) %>% 
  dplyr::select(-draw)
```

```{r echo = FALSE}
# Summarize
summ_data <- data.frame(t(sapply(calib_data, function(x) 
  list(mean = round(mean(x,na.rm=TRUE), 4), sd = round(sd(x,na.rm=TRUE), 4) ))))
#Change rownames to new column
summ_data$variable <- rownames(summ_data)
#Remove rownames
rownames(summ_data) <- NULL
#Make variable column as 1st column
sums<-cbind(summ_data[ncol(summ_data)], summ_data[-ncol(summ_data)])
print.data.frame(sums, row.names = FALSE)
```

<div style="margin-bottom:50x;">
</div>
### Baseline welfare calculations
After calibrating the simulation model to 2020 fishery conditions, I re-ran the model under two closure scenarios: (a) bag limits for both cod and haddock set to zero, and (b) bag limits for cod only set to zero.  
$~$
```{r include = FALSE}
library(readxl)
full_closure<-data.frame(read_excel("baseline_welfare.xlsx"))
full_closure<-full_closure %>% 
  dplyr::mutate(scenario="full_closure")

cod_closure<-data.frame(read_excel("baseline_welfare_close_cod.xlsx"))
cod_closure<-cod_closure %>% 
  dplyr::mutate(scenario="cod_closure")

join_df=rbind.fill(full_closure,cod_closure)
join_df<-join_df #%>% dplyr::select(-group)

cv_sum_full_closure<- full_closure$cv_sum
cv_sum_full_cod_closure<- cod_closure$cv_sum
```
<div style="margin-bottom:50x;">
</div>
#### Scenario (a): close both fisheries 
CV per choice occasion
```{r echo = FALSE}
# Summarize
full_closure1 <- full_closure %>% 
  summarise(
    mean = round(mean(cv_sum/n_choice_occasions_sum), 2),
    sd = round(sd(cv_sum/n_choice_occasions_sum), 2)) 
print.data.frame(full_closure1, row.names = FALSE)
```
Aggregate CV
```{r echo = FALSE}
full_closure1 <- full_closure %>% 
  summarise(
    mean = round(mean(cv_sum), 2),
    sd = round(sd(cv_sum), 2))
print.data.frame(full_closure1, row.names = FALSE)
```

Number of trips under closure
```{r echo = FALSE}
full_closure1 <- full_closure %>% 
  summarise(
    mean = round(mean(ntrips_sum), 2),
    sd = round(sd(ntrips_sum), 2))
print.data.frame(full_closure1, row.names = FALSE)
``` 

Number of trips under baseline fishery
```{r echo = FALSE}
full_closure1 <- full_closure %>% 
  summarise(
    mean = round(mean(ntrips_sum_baseline), 2),
    sd = round(sd(ntrips_sum_baseline), 2) )
print.data.frame(full_closure1, row.names = FALSE)
```

Percent reduction in trips from baseline fishery
```{r echo = FALSE}
full_closure1 <- full_closure %>% 
  summarise(
    mean = round(mean( ((ntrips_sum-ntrips_sum_baseline)/ntrips_sum_baseline)*100), 2),
    sd = round(sd(((ntrips_sum-ntrips_sum_baseline)/ntrips_sum_baseline)*100), 2) )
print.data.frame(full_closure1, row.names = FALSE)
```
<div style="margin-bottom:50px;">
</div>
#### Scenario (b): close cod only 
CV per choice occasion
```{r echo = FALSE}
# Summarize
cod_closure1<-cod_closure %>%
  summarise(
    mean = round(mean(cv_sum/n_choice_occasions_sum), 2),
    sd = round(sd(cv_sum/n_choice_occasions_sum), 2)) 
print.data.frame(cod_closure1, row.names = FALSE)
```
Aggregate CV
```{r echo = FALSE}
cod_closure1<-cod_closure %>%
  summarise(
    mean = round(mean(cv_sum), 2),
    sd = round(sd(cv_sum), 2))
print.data.frame(cod_closure1, row.names = FALSE)
```

Number of trips under closure
```{r echo = FALSE}
cod_closure1<-cod_closure %>%
  summarise(
    mean = round(mean(ntrips_sum), 2),
    sd = round(sd(ntrips_sum), 2))
print.data.frame(cod_closure1, row.names = FALSE)
``` 

 Number of trips under baseline fishery
```{r echo = FALSE}
cod_closure1<-cod_closure %>%
  summarise(    
    mean = round(mean(ntrips_sum_baseline), 2),
    sd = round(sd(ntrips_sum_baseline), 2))
print.data.frame(cod_closure1, row.names = FALSE)
```
Percent reduction in trips from baseline fishery
```{r echo = FALSE}
cod_closure1 <- cod_closure %>% 
  summarise(
    mean = round(mean( ((ntrips_sum-ntrips_sum_baseline)/ntrips_sum_baseline)*100), 2),
    sd = round(sd(((ntrips_sum-ntrips_sum_baseline)/ntrips_sum_baseline)*100), 2) )
print.data.frame(cod_closure1, row.names = FALSE)
```

<div style="margin-bottom:50px;">
</div>

### Annual fishery outcomes under climate-induced changes in catch-per-trip
Each tab contains projected fishery outcomes based on input data from alternative copula models. 

## {.tabset}

### Clayton (independent catch)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__clayton_ind.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est), .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)


plot1<-ggplot(predictions_data, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cv_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("CV per choice occasion", label=comma, breaks=seq(-70,-30,5))

plot2<- ggplot(predictions_data, aes(x=decade, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data, aes(x=decade, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```


### Clayton (correlated catch)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__clayton_corr.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)


plot1<-ggplot(predictions_data, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

CV per choice occasion and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cv_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("CV per choice occasion", label=comma, breaks=seq(-70,-30,5))

plot2<- ggplot(predictions_data, aes(x=decade, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data, aes(x=decade, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```


### Gumbel (independent catch)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__gumbel_ind.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum), 
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)


plot1<-ggplot(predictions_data, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

CV per choice occasion and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cv_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("CV per choice occasion", label=comma, breaks=seq(-70,-30,5))

plot2<- ggplot(predictions_data, aes(x=decade, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data, aes(x=decade, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

### Gumbel (correlated catch)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__gumbel_corr.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)


plot1<-ggplot(predictions_data, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

CV per choice occasion and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cv_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("CV per choice occasion", label=comma, breaks=seq(-70,-30,5))

plot2<- ggplot(predictions_data, aes(x=decade, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data, aes(x=decade, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

### Frank (independent catch)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__frank_ind.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)


plot1<-ggplot(predictions_data, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

CV per choice occasion and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cv_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("CV per choice occasion", label=comma, breaks=seq(-70,-30,5))

plot2<- ggplot(predictions_data, aes(x=decade, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data, aes(x=decade, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

### Frank (correlated catch)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__frank_corr.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)


plot1<-ggplot(predictions_data, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

CV per choice occasion and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cv_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("CV per choice occasion", label=comma, breaks=seq(-70,-30,5))

plot2<- ggplot(predictions_data, aes(x=decade, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data, aes(x=decade, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

### All copulas (correlated catch, decade=1)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data1<- read_excel("predictions__frank_corr.xlsx") 
predictions_data1 <-predictions_data1 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==1)

predictions_data2<- read_excel("predictions__clayton_corr.xlsx") 
predictions_data2 <-predictions_data2 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==1)

predictions_data3<- read_excel("predictions__gumbel_corr.xlsx") 
predictions_data3 <-predictions_data3 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==1)

predictions_data4<-rbind(predictions_data1, predictions_data2, predictions_data3)

predictions_data5<- predictions_data4  %>%
  dplyr::group_by(copula, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)

plot1<-ggplot(predictions_data5, aes(x=copula, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data5, aes(x=copula, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data5, aes(x=copula, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data5, aes(x=copula, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

CV per choice occasion and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data5, aes(x=copula, y=cv_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("CV per choice occasion", label=comma)

plot2<- ggplot(predictions_data5, aes(x=copula, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data5, aes(x=copula, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data5, aes(x=copula, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

### All copulas (correlated catch, decade=4)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data1<- read_excel("predictions__frank_corr.xlsx") 
predictions_data1 <-predictions_data1 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==4)

predictions_data2<- read_excel("predictions__clayton_corr.xlsx") 
predictions_data2 <-predictions_data2 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==4)

predictions_data3<- read_excel("predictions__gumbel_corr.xlsx") 
predictions_data3 <-predictions_data3 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==4)

predictions_data4<-rbind(predictions_data1, predictions_data2, predictions_data3)

predictions_data5<- predictions_data4  %>%
  dplyr::group_by(copula, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)

plot1<-ggplot(predictions_data5, aes(x=copula, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data5, aes(x=copula, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data5, aes(x=copula, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data5, aes(x=copula, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

CV per choice occasion and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data5, aes(x=copula, y=cv_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("CV per choice occasion", label=comma)

plot2<- ggplot(predictions_data5, aes(x=copula, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data5, aes(x=copula, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data5, aes(x=copula, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

### All copulas (correlated catch, decade=8)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data1<- read_excel("predictions__frank_corr.xlsx") 
predictions_data1 <-predictions_data1 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==8)

predictions_data2<- read_excel("predictions__clayton_corr.xlsx") 
predictions_data2 <-predictions_data2 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==8)

predictions_data3<- read_excel("predictions__gumbel_corr.xlsx") 
predictions_data3 <-predictions_data3 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==8)

predictions_data4<-rbind(predictions_data1, predictions_data2, predictions_data3)
predictions_data5<- predictions_data4  %>%
  dplyr::group_by(copula, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)

plot1<-ggplot(predictions_data5, aes(x=copula, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data5, aes(x=copula, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data5, aes(x=copula, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data5, aes(x=copula, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

CV per choice occasion and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data5, aes(x=copula, y=cv_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("CV per choice occasion", label=comma)

plot2<- ggplot(predictions_data5, aes(x=copula, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data5, aes(x=copula, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data5, aes(x=copula, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

## {-}

<div style="margin-bottom:50px;">
</div>

### Monthly fishery outcomes under climate-induced changes in catch-per-trip
Each tab contains projected fishery outcomes at the monthly level based on input data from alternative copula models. 

## {.tabset}

### Clayton (independent catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__clayton_ind.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

### Clayton (correlated catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__clayton_corr.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

### Gumbel (independent catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__gumbel_ind.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

### Gumbel (correlated catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__gumbel_corr.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

### Frank (independent catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__frank_ind.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
### Frank (correlated catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__frank_corr.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```


