

---
title: "GoM cod and haddock RDM"
author: "Lou Carr-Harris"
date: "`r Sys.Date()`"
output: 
  html_document:
    theme: cerulean
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(comment = NA)
cat('<pre>')
pkgs_to_use <- c("tidyr",  "magrittr", "tidyverse", "reshape2","splitstackshape",
                 "doBy","WriteXLS","Rcpp", "ggplot2","dplyr", "rlist","fitdistrplus",
                 "MASS",  "psych", "rgl","copula", "VineCopula","scales","univariateML",
                 "logspline","readr","data.table","conflicted", "readxl", "writexl", "stringr",
                 "plyr" , "furrr", "profvis", "future", "Hmisc", "tictoc", "sjPlot", "gridExtra", 
                 "rmdformats", "prettydoc", "hrbrthemes", "tint", "tufte", "knitr", "hrbrthemes")
install.packages(setdiff(pkgs_to_use, rownames(installed.packages())))  
lapply(pkgs_to_use, library, character.only = TRUE, quietly = TRUE)
conflict_prefer("filter", "dplyr")
conflict_prefer("select", "dplyr")
conflict_prefer("mutate", "dplyr")
conflict_prefer("rename", "dplyr")
conflict_prefer("summarize", "dplyr")
conflict_prefer("summarise", "dplyr")
conflict_prefer("count", "dplyr")
```
This file is an exploratory analysis of the effect of climate-induced shifts in angler catch-per-trip of Gulf of Maine cod and haddock. Results are based on 100 iterations of the recreation demand model. The RDM is calibrated to 2020 fishery conditions.   

### Decadal bottom trends
Mean monthly bottom temps by decade, red line indicates decadal average. Bars represent mean monthly temp +/- 1.96*standard dev.   
```{r echo = FALSE, fig.width=8, fig.height=6}
#projection data
# bt_temp_project <- data.frame(read_csv("decadal_bottom_temp_distributions_levels_05-15-2023.csv", show_col_types = FALSE))
bt_temp_project <- data.frame(read_csv("decadal_bottom_temp_distributions_levels_05-28-2024.csv", show_col_types = FALSE))

bt_temp_project<-bt_temp_project %>%
  dplyr::mutate(lower = average_temp-1.96*sd_temp,
                upper = average_temp+1.96*sd_temp) %>%
  dplyr::group_by(decade) %>%
  dplyr::mutate(mean_decadal_tmp=mean(average_temp)) %>%
  dplyr::rename(decade2= decade) %>%
  dplyr::mutate(decade = case_when(decade2==1~'2021-2030',
                                   decade2==2~'2031-2040',
                                   decade2==3~'2041-2050',
                                   decade2==4~'2051-2060',
                                   decade2==5~'2061-2070',
                                   decade2==6~'2071-2080',
                                   decade2==7~'2081-2090',
                                   decade2==8~'2091-3000')) %>%
  dplyr::ungroup() %>% 
  dplyr::select(-n, -decade2) %>% 
  dplyr::rename(mean_temp=average_temp)%>% 
  dplyr::mutate(month=as.numeric(month))


#historical data

GOM_mean_bt_temps<-read_excel("U:/mean_bottom_temps_GOM_cod_hadd.xlsx")

GOM_mean_bt_temps_means<-GOM_mean_bt_temps %>%
  dplyr::mutate(year=as.numeric(year), 
                month=as.numeric(month)) %>% 
  dplyr::mutate(decade = case_when(year>=2011 & year<=2020 ~ '2011-2020',
                                   year>=2001 & year<=2010 ~ '2001-2010',
                                   year>=1991 & year<=2000 ~ '1991-2000',
                                   year>=1981 & year<=1990 ~ '1981-1990',
                                   year>=1971 & year<=1980 ~ '1971-1980',
                                   year>=1961 & year<=1970 ~ '1961-1970')) %>% 
  dplyr::group_by(decade, month) %>% 
  dplyr::summarize(mean_temp=mean(bt_tmp), 
                   sd_temp=sd(bt_tmp), .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::group_by(decade) %>% 
  dplyr::mutate(mean_decadal_tmp=mean(mean_temp)) %>% 
  dplyr::filter(!is.na(decade)) %>% 
  dplyr::mutate(lower = mean_temp-1.96*sd_temp,
                upper = mean_temp+1.96*sd_temp) %>% 
  dplyr::mutate(month=as.numeric(month))

historical_and_projections<- rbind(GOM_mean_bt_temps_means, bt_temp_project)
    
#GOM_mean_bt_temps_means_check<-GOM_mean_bt_temps_means %>% 
#  dplyr::filter(year>1990 & year<=2020)

# plot1<-  
  
ggplot(historical_and_projections, aes(month, mean_temp)) + geom_point() + 
  geom_errorbar(aes(ymin = lower, ymax = upper))+
  facet_wrap(~decade, nrow = 1) + #scale_x_continuous(breaks=seq(1,12,1)) +
  # scale_y_continuous(limits = c(3.5,12.5)) +
  theme(axis.text.x = element_blank(),  strip.text = element_text(size = 7, margin = margin()), 
         axis.ticks.x=element_blank()) +
  geom_hline(data=historical_and_projections, aes(yintercept=mean_decadal_tmp) ,color="red")+
  labs( x=NULL, y = "Sea bottom temperature (Â°C)") +ggtitle("Historical and projected average monthly sea bottom temperatures in the Gulf of Maine")
```

Projected differences in average monthly sea bottom temperatures relative to 2020. Bars represent lower and upper bounds of the projected average monthly temperatures. Red lines indicate differences between the decadal and 2020 annual average.
```{r echo = FALSE, fig.width=8, fig.height=6}
#projection data
bt_temp_project <- data.frame(read_csv("decadal_bottom_temp_distributions_levels_05-28-2024.csv", show_col_types = FALSE))

bt_temp_project<-bt_temp_project %>%
  dplyr::mutate(lower = average_temp-1.96*sd_temp,
                upper = average_temp+1.96*sd_temp) %>%
  dplyr::group_by(decade) %>%
  dplyr::mutate(mean_decadal_tmp=mean(average_temp)) %>%
  dplyr::rename(decade2= decade) %>%
  dplyr::mutate(decade = case_when(decade2==1~'2021-2030',
                                   decade2==2~'2031-2040',
                                   decade2==3~'2041-2050',
                                   decade2==4~'2051-2060',
                                   decade2==5~'2061-2070',
                                   decade2==6~'2071-2080',
                                   decade2==7~'2081-2090',
                                   decade2==8~'2091-3000')) %>%
  dplyr::ungroup() %>% 
  dplyr::select(-n, -decade2) %>% 
  dplyr::rename(mean_temp=average_temp)%>% 
  dplyr::mutate(month=as.numeric(month))


#historical data

GOM_mean_bt_temps<-read_excel("U:/mean_bottom_temps_GOM_cod_hadd.xlsx")

GOM_mean_bt_temps_means<-GOM_mean_bt_temps %>%
  dplyr::mutate(year=as.numeric(year), 
                month=as.numeric(month)) %>%
  dplyr::filter(year==2020) %>% 
  dplyr::rename(bt_temp_2020=bt_tmp) %>% 
  dplyr::group_by(year) %>% 
  dplyr::mutate(mean_annual_tmp_2020=mean(bt_temp_2020)) %>% 
  dplyr::ungroup()

temp_diff<-GOM_mean_bt_temps_means %>% 
  dplyr::right_join(bt_temp_project, by="month") %>% 
  dplyr::mutate(temp_diff=mean_temp-bt_temp_2020, 
                temp_diff_lower=lower-bt_temp_2020, 
                temp_diff_upper=upper-bt_temp_2020, 
                temp_diff_annual=mean_decadal_tmp-mean_annual_tmp_2020)%>% 
  dplyr::arrange(decade, month) 
  
ggplot(temp_diff, aes(month, temp_diff)) + geom_point() + 
  geom_errorbar(aes(ymin = temp_diff_lower, ymax = temp_diff_upper))+ 
  facet_wrap(~decade, nrow = 1) + #scale_x_continuous(breaks=seq(1,12,1)) +
  #scale_y_continuous(limits = c(3.5,12.5)) +
  theme(axis.text.x = element_blank(),  strip.text = element_text(size = 10, margin = margin()), 
         axis.ticks.x=element_blank()) +
  geom_hline(data=temp_diff, aes(yintercept=temp_diff_annual) ,color="red")+
  labs( x=NULL, y = "Projected temperature - 2020 temperature") +ggtitle("Projected differences in average monthly sea bottom temperatures relative to 2020")

temp_diff1<- temp_diff %>% 
  dplyr::select(decade, month,temp_diff ) %>% 
  dplyr::rename(decade2= decade) %>%
  dplyr::mutate(decade = case_when(decade2=='2021-2030'~1,
                                   decade2=='2031-2040'~2,
                                   decade2=='2041-2050'~3,
                                   decade2=='2051-2060'~4,
                                   decade2=='2061-2070'~5,
                                   decade2=='2071-2080'~6,
                                   decade2=='2081-2090'~7,
                                   decade2=='2091-3000'~8)) %>% 
  dplyr::select(-decade2)  %>% 
  dplyr::mutate(decade=as.numeric(decade)) %>% 
  dplyr::mutate(month=as.numeric(month)) 

  
```

### Baseline (2020) fishery statistics
Index "_i" indicates per choice occasion variable 

```{r echo = FALSE}
calib_data <- readRDS("C:/Users/andrew.carr-harris/Desktop/Git/welfare-model-GoM/calibration_data/calibration_data_all_2020.rds")
calib_data<-calib_data %>% 
  dplyr::group_by(draw) %>% 
  dplyr::summarise(estimated_trips=sum(estimated_trips),
                   n_choice_occasions = sum(n_choice_occasions),
                   tot_cod_catch= sum(tot_cod_catch), 
                   tot_keep_cod = sum(tot_keep_cod), 
                   tot_rel_cod = sum(tot_rel_cod), 
                   
                   tot_hadd_catch = sum(tot_hadd_catch), 
                   tot_keep_hadd = sum(tot_keep_hadd),
                   tot_rel_hadd = sum(tot_rel_hadd)) %>% 
  
  dplyr::mutate(cod_keep_i=tot_keep_cod/n_choice_occasions, 
                hadd_keep_i=tot_keep_hadd/n_choice_occasions,
                cod_keep_trip=tot_keep_cod/estimated_trips, 
                hadd_keep_trip=tot_keep_hadd/estimated_trips, 
                cod_catch_i=tot_cod_catch/n_choice_occasions, 
                hadd_catch_i=tot_hadd_catch/n_choice_occasions, 
                cod_catch_trip=tot_cod_catch/estimated_trips, 
                hadd_catch_trip=tot_hadd_catch/estimated_trips)  #%>% 
  #dplyr::select(-draw)
```

```{r echo = FALSE}
# Summarize
summ_data <- data.frame(t(sapply(calib_data, function(x) 
  list(mean = round(mean(x,na.rm=TRUE), 4), sd = round(sd(x,na.rm=TRUE), 4) ))))
#Change rownames to new column
summ_data$variable <- rownames(summ_data)
#Remove rownames
rownames(summ_data) <- NULL
#Make variable column as 1st column
sums<-cbind(summ_data[ncol(summ_data)], summ_data[-ncol(summ_data)])
print.data.frame(sums, row.names = FALSE)
```

<div style="margin-bottom:50x;">
</div>
### Baseline welfare calculations
After calibrating the simulation model to 2020 fishery conditions, I re-ran the model under two closure scenarios: (a) bag limits for both cod and haddock set to zero, and (b) bag limits for cod only set to zero.  
$~$
```{r include = FALSE}
library(readxl)
full_closure<-data.frame(read_excel("baseline_welfare.xlsx"))
full_closure<-full_closure %>% 
  dplyr::mutate(scenario="full_closure")

cod_closure<-data.frame(read_excel("baseline_welfare_close_cod.xlsx"))
cod_closure<-cod_closure %>% 
  dplyr::mutate(scenario="cod_closure")

join_df=rbind.fill(full_closure,cod_closure)
join_df<-join_df #%>% dplyr::select(-group)

cv_sum_full_closure<- full_closure$cv_sum
cv_sum_full_cod_closure<- cod_closure$cv_sum
```
<div style="margin-bottom:50x;">
</div>
#### Scenario (a): close both fisheries 
CV per choice occasion
```{r echo = FALSE}
# Summarize
full_closure1 <- full_closure %>% 
  summarise(
    mean = round(mean(cv_sum/n_choice_occasions_sum), 2),
    sd = round(sd(cv_sum/n_choice_occasions_sum), 2)) 
print.data.frame(full_closure1, row.names = FALSE)
```
Aggregate CV
```{r echo = FALSE}
full_closure1 <- full_closure %>% 
  summarise(
    mean = round(mean(cv_sum), 2),
    sd = round(sd(cv_sum), 2))
print.data.frame(full_closure1, row.names = FALSE)
```

Number of trips under closure
```{r echo = FALSE}
full_closure1 <- full_closure %>% 
  summarise(
    mean = round(mean(ntrips_sum), 2),
    sd = round(sd(ntrips_sum), 2))
print.data.frame(full_closure1, row.names = FALSE)
``` 

Number of trips under baseline fishery
```{r echo = FALSE}
full_closure1 <- full_closure %>% 
  summarise(
    mean = round(mean(ntrips_sum_baseline), 2),
    sd = round(sd(ntrips_sum_baseline), 2) )
print.data.frame(full_closure1, row.names = FALSE)
```

Percent reduction in trips from baseline fishery
```{r echo = FALSE}
full_closure1 <- full_closure %>% 
  summarise(
    mean = round(mean( ((ntrips_sum-ntrips_sum_baseline)/ntrips_sum_baseline)*100), 2),
    sd = round(sd(((ntrips_sum-ntrips_sum_baseline)/ntrips_sum_baseline)*100), 2) )
print.data.frame(full_closure1, row.names = FALSE)
```
<div style="margin-bottom:50px;">
</div>
#### Scenario (b): close cod only 
CV per choice occasion
```{r echo = FALSE}
# Summarize
cod_closure1<-cod_closure %>%
  summarise(
    mean = round(mean(cv_sum/n_choice_occasions_sum), 2),
    sd = round(sd(cv_sum/n_choice_occasions_sum), 2)) 
print.data.frame(cod_closure1, row.names = FALSE)
```
Aggregate CV
```{r echo = FALSE}
cod_closure1<-cod_closure %>%
  summarise(
    mean = round(mean(cv_sum), 2),
    sd = round(sd(cv_sum), 2))
print.data.frame(cod_closure1, row.names = FALSE)
```

Number of trips under closure
```{r echo = FALSE}
cod_closure1<-cod_closure %>%
  summarise(
    mean = round(mean(ntrips_sum), 2),
    sd = round(sd(ntrips_sum), 2))
print.data.frame(cod_closure1, row.names = FALSE)
``` 

 Number of trips under baseline fishery
```{r echo = FALSE}
cod_closure1<-cod_closure %>%
  summarise(    
    mean = round(mean(ntrips_sum_baseline), 2),
    sd = round(sd(ntrips_sum_baseline), 2))
print.data.frame(cod_closure1, row.names = FALSE)
```
Percent reduction in trips from baseline fishery
```{r echo = FALSE}
cod_closure1 <- cod_closure %>% 
  summarise(
    mean = round(mean( ((ntrips_sum-ntrips_sum_baseline)/ntrips_sum_baseline)*100), 2),
    sd = round(sd(((ntrips_sum-ntrips_sum_baseline)/ntrips_sum_baseline)*100), 2) )
print.data.frame(cod_closure1, row.names = FALSE)
```

### Historical projected fishery outcomes  {.tabset}
#### Total CV

```{r echo = FALSE}
hist_predictions_data1<- rbind(read_excel("predictions_historical_v2__clayton_corr.xlsx"),
                               read_excel("predictions_historical_v2__frank_corr.xlsx"), 
                               read_excel("predictions_historical_v2__plackett_corr.xlsx"),
                               read_excel("predictions_historical_v2__gaussian_corr.xlsx"),
                               read_excel("predictions_historical_v2__gumbel_corr.xlsx")) %>% 
  dplyr::mutate(prediction_year=as.numeric(prediction_year)) %>% 
  dplyr::group_by(draw, copula, prediction_year) %>% 
  dplyr::summarise(estimated_trips=sum(ntrips_alt_sum),
                   tot_cod_catch= sum(cod_catch_sum), 
                   tot_keep_cod = sum(cod_keep_sum), 
                   tot_hadd_catch = sum(hadd_catch_sum), 
                   tot_keep_hadd = sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),.groups = 'drop') %>%
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_trip=tot_keep_cod/estimated_trips, 
                hadd_keep_trip=tot_keep_hadd/estimated_trips, 
                cod_catch_trip=tot_cod_catch/estimated_trips, 
                hadd_catch_trip=tot_hadd_catch/estimated_trips, 
                cv_trip=cv_sum/estimated_trips) 

hist_predictions_data2<- rbind(read_excel("predictions_historical_v2__clayton_ind.xlsx"),
                               read_excel("predictions_historical_v2__frank_ind.xlsx"), 
                               read_excel("predictions_historical_v2__plackett_ind.xlsx"),
                               read_excel("predictions_historical_v2__gaussian_ind.xlsx"),
                               read_excel("predictions_historical_v2__gumbel_ind.xlsx")) %>% 
  dplyr::mutate(prediction_year=as.numeric(prediction_year)) %>% 
  dplyr::group_by(draw, copula, prediction_year) %>% 
  dplyr::summarise(estimated_trips_ind=sum(ntrips_alt_sum),
                   tot_cod_catch_ind= sum(cod_catch_sum), 
                   tot_keep_cod_ind = sum(cod_keep_sum), 
                   tot_hadd_catch_ind = sum(hadd_catch_sum), 
                   tot_keep_hadd_ind = sum(hadd_catch_sum),
                   cv_sum_ind=sum(cv_sum),.groups = 'drop') %>%
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_trip_ind=tot_keep_cod_ind/estimated_trips_ind, 
                hadd_keep_trip_ind=tot_keep_hadd_ind/estimated_trips_ind, 
                cod_catch_trip_ind=tot_cod_catch_ind/estimated_trips_ind, 
                hadd_catch_trip_ind=tot_hadd_catch_ind/estimated_trips_ind, 
                cv_trip_ind=cv_sum_ind/estimated_trips_ind)

hist_predictions_data3<-hist_predictions_data2 %>% 
  dplyr::left_join(hist_predictions_data1, by=c("draw", "copula", "prediction_year")) %>% 
  dplyr::mutate(cv_trip_diff=cv_trip-cv_trip_ind, 
                cv_sum_diff=cv_sum-cv_sum_ind)

```

```{r echo = FALSE}
ggplot(hist_predictions_data3, aes(x=factor(prediction_year), y=cv_sum, color = factor(copula)))+
     geom_boxplot() 
```


#### Difference in CV between ind. and corr (cv_sum_corr-cv_sum_ind)
```{r echo = FALSE}
ggplot(hist_predictions_data3, aes(x=factor(prediction_year), y=cv_sum_diff, color = factor(copula)))+
     geom_boxplot() 
```
### {-}

### Annual fishery outcomes under climate-induced changes in catch-per-trip {.tabset}
Each tab contains projected fishery outcomes based on input data from alternative copula models. 
#### Changes catch outcomes and temperatures relative to 2020

```{r echo = FALSE}

dtrip_check<-data.frame(read_csv("directed trips and regulations 2010_2020.csv", show_col_types = FALSE))
  dtrip_check<-dtrip_check %>% 
    dplyr::mutate(dtrip=round(dtrip)) %>% 
    dplyr::filter(year==2020) %>% 
    dplyr::filter(dtrip!=0) %>% 
    dplyr::select(-year) %>% 
    dplyr::group_by(month) %>% 
    dplyr::summarise(sum_trip=sum(dtrip), .groups='drop') 
  
temp_2020<-data.frame(read_csv("C:/Users/andrew.carr-harris/Desktop/GoM correlated catch data/historical_correlated_sample_Clayton.csv", show_col_types = FALSE))
temp_2020<-temp_2020 %>% 
  dplyr::filter(year==2020) %>% 
  dplyr::mutate(month=as.numeric(month))   %>% 
  dplyr::group_by(month) %>% 
  dplyr::summarise(mean_temp_2020=mean(bt_tmp), .groups='drop') 

temp_project<-data.frame(read_csv("C:/Users/andrew.carr-harris/Desktop/GoM correlated catch data/correlated_sample_Clayton_v2.csv", show_col_types = FALSE))
temp_project<-temp_project %>% 
  dplyr::mutate(month=as.numeric(month))   %>% 
  dplyr::group_by(decade, month) %>% 
  dplyr::summarise(mean_temp=mean(average_temp), .groups='drop') 

temp_diff<-temp_project %>% 
  dplyr::left_join(temp_2020, by="month") %>% 
  dplyr::mutate(temp_diff=mean_temp-mean_temp_2020)

calib_data2 <- readRDS("C:/Users/andrew.carr-harris/Desktop/Git/welfare-model-GoM/calibration_data/calibration_data_all_2020.rds")
calib_data2<-calib_data2 %>% 
  dplyr::mutate(month=as.numeric(month))   %>% 
  dplyr::group_by(draw, month) %>% 
  dplyr::summarise(estimated_trips=sum(estimated_trips),
                   n_choice_occasions = sum(n_choice_occasions),
                   tot_cod_catch= sum(tot_cod_catch), 
                   tot_keep_cod = sum(tot_keep_cod), 
                   tot_rel_cod = sum(tot_rel_cod), 
                   tot_hadd_catch = sum(tot_hadd_catch), 
                   tot_keep_hadd = sum(tot_keep_hadd),
                   tot_rel_hadd = sum(tot_rel_hadd), .groups='drop') %>% 
  dplyr::mutate(cod_keep_i=tot_keep_cod/n_choice_occasions, 
                hadd_keep_i=tot_keep_hadd/n_choice_occasions,
                cod_keep_trip=tot_keep_cod/estimated_trips, 
                hadd_keep_trip=tot_keep_hadd/estimated_trips, 
                cod_catch_i=tot_cod_catch/n_choice_occasions, 
                hadd_catch_i=tot_hadd_catch/n_choice_occasions, 
                cod_catch_trip=tot_cod_catch/estimated_trips, 
                hadd_catch_trip=tot_hadd_catch/estimated_trips) %>% 
  dplyr::select(draw,month, cod_keep_trip, hadd_keep_trip, cod_catch_trip, hadd_catch_trip, tot_cod_catch, tot_keep_cod, tot_hadd_catch, tot_keep_hadd) %>% 
  dplyr::rename(cod_keep_trip_2020=cod_keep_trip,
                hadd_keep_trip_2020=hadd_keep_trip, 
                cod_catch_trip_2020=cod_catch_trip, 
                hadd_catch_trip_2020=hadd_catch_trip, 
                tot_cod_catch_2020=tot_cod_catch,
                tot_keep_cod_2020=tot_keep_cod, 
                tot_hadd_catch_2020=tot_hadd_catch,
                tot_keep_hadd_2020=tot_keep_hadd)

predictions_data2<- read_excel("predictions_v2__gaussian_ind.xlsx") 
predictions_data2 <-predictions_data2 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  dplyr::mutate(decade=as.numeric(decade)) %>% 
  dplyr::mutate(month=as.numeric(month))   %>% 
  dplyr::group_by(decade, draw, month, copula) %>%
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est), .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices,
                cv_sum_inv=-cv_sum,
                cv_trip=cv_sum/ntrips_sum,
                cod_keep_trip=cod_keep_sum/ntrips_sum,
                hadd_keep_trip=hadd_keep_sum/ntrips_sum,
                cod_catch_trip=cod_catch_sum/ntrips_sum,
                hadd_catch_trip=hadd_catch_sum/ntrips_sum) %>% 
  dplyr::ungroup()  %>% 
  dplyr::select(draw, month,decade, cod_keep_trip,hadd_keep_trip,cod_catch_trip, hadd_catch_trip, cod_keep_sum, hadd_keep_sum, cod_catch_sum, hadd_catch_sum ) %>% 
  dplyr::left_join(calib_data2, by=c("month", "draw")) %>% 
  dplyr::mutate(diff_cod_keep_trip=cod_keep_trip-cod_keep_trip_2020, 
                diff_hadd_keep_trip=hadd_keep_trip-hadd_keep_trip_2020,
                diff_cod_catch_trip=cod_catch_trip-cod_catch_trip_2020, 
                diff_hadd_catch_trip=hadd_catch_trip-hadd_catch_trip_2020, 
                diff_cod_catch=cod_catch_sum-tot_cod_catch_2020, 
                diff_hadd_catch=hadd_catch_sum-tot_hadd_catch_2020,
                diff_cod_keep=cod_keep_sum-tot_keep_cod_2020, 
                diff_hadd_keep=hadd_keep_sum-tot_keep_hadd_2020) %>% 
  dplyr::mutate(decade=as.numeric(decade)) %>% 
  dplyr::mutate(month=as.numeric(month)) %>% 
  dplyr::group_by(decade, month) %>% 
  dplyr::summarize(#temp_diff=mean(temp_diff), 
                diff_cod_keep_trip=mean(diff_cod_keep_trip),
                diff_hadd_keep_trip=mean(diff_hadd_keep_trip),
                diff_cod_catch_trip=mean(diff_cod_catch_trip),
                diff_hadd_catch_trip=mean(hadd_catch_trip), 
                diff_tot_cod_catch=mean(diff_cod_catch), 
                diff_tot_hadd_catch=mean(diff_hadd_catch), 
                diff_tot_cod_keep=mean(diff_cod_keep), 
                diff_tot_hadd_keep=mean(diff_hadd_keep), 
                cod_keep_trip=mean(cod_keep_trip), 
                hadd_keep_trip=mean(hadd_keep_trip), 
                cod_catch_trip=mean(cod_catch_trip), 
                hadd_catch_trip=mean(hadd_catch_trip),
                .groups='drop')%>% 
  dplyr::left_join(temp_diff, by=c("month", "decade")) 
  
#normalized values
predictions_data2 <-predictions_data2 %>% 
  dplyr::group_by(decade) %>% 
  dplyr::mutate(temp_diff_normal=((temp_diff-min(temp_diff))/(max(temp_diff)-min(temp_diff))), 
    diff_cod_keep_trip_normal=((diff_cod_keep_trip-min(diff_cod_keep_trip))/(max(diff_cod_keep_trip)-min(diff_cod_keep_trip))), 
    diff_hadd_keep_trip_normal=((diff_hadd_keep_trip-min(diff_hadd_keep_trip))/(max(diff_hadd_keep_trip)-min(diff_hadd_keep_trip))), 
    cod_keep_trip_normal=((cod_keep_trip-min(cod_keep_trip))/(max(cod_keep_trip)-min(cod_keep_trip))), 
    hadd_keep_trip_normal=((hadd_keep_trip-min(hadd_keep_trip))/(max(hadd_keep_trip)-min(hadd_keep_trip))), 
    cod_catch_trip_normal=((cod_catch_trip-min(cod_catch_trip))/(max(cod_catch_trip)-min(cod_catch_trip))), 
    hadd_catch_trip_normal=((hadd_catch_trip-min(hadd_catch_trip))/(max(hadd_catch_trip)-min(hadd_catch_trip)))) 
    
temperatureColor <- "#69b3a2"
catch_color <- rgb(0.2, 0.6, 0.9, 1)
coeff <- 1
ggplot(predictions_data2, aes(x=month)) +
  geom_line( aes(y=temp_diff),  color=temperatureColor) + 
  geom_line( aes(y=hadd_keep_trip_normal), color=catch_color) +
  facet_wrap(~decade, nrow = 1)+
  scale_y_continuous(
    # Features of the first axis
    name = "Temperature difference",
    # Add a second axis and specify its features
    sec.axis = sec_axis(~.*coeff, name="Haddock keep per trip")) + 
   theme(axis.title.y = element_text(color = temperatureColor, size=13),
            axis.title.y.right = element_text(color = catch_color, size=13)) +
  ggtitle("Normalized difference in temperature vs. normalized haddock keep per trip")

```

#### Projected decadal CV as a proportion of CV under full-closure of 2020 fishery
```{r echo = FALSE}
full_closure<-data.frame(read_excel("baseline_welfare.xlsx"))
full_closure<-full_closure %>% 
  dplyr::select(draw, cv_sum) %>% 
  dplyr::rename(cv_sum_closure=cv_sum)

predictions_data1<- read_excel("predictions_v2__frank_corr.xlsx") 
predictions_data1 <-predictions_data1 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw, copula) %>% 
  dplyr::summarise(cv_sum=sum(cv_sum), .groups = 'drop') %>% 
  dplyr::ungroup() 

predictions_data2<- read_excel("predictions_v2__clayton_corr.xlsx") 
predictions_data2 <-predictions_data2 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw, copula) %>% 
  dplyr::summarise(cv_sum=sum(cv_sum), .groups = 'drop') %>% 
  dplyr::ungroup()  

predictions_data3<- read_excel("predictions_v2__gumbel_corr.xlsx") 
predictions_data3 <-predictions_data3 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw, copula) %>% 
  dplyr::summarise(cv_sum=sum(cv_sum), .groups = 'drop') %>% 
  dplyr::ungroup()  

predictions_data4<- read_excel("predictions_v2__plackett_corr.xlsx") 
predictions_data4 <-predictions_data4 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw, copula) %>% 
  dplyr::summarise(cv_sum=sum(cv_sum), .groups = 'drop') %>% 
  dplyr::ungroup()  

predictions_data5<- read_excel("predictions_v2__gaussian_corr.xlsx") 
predictions_data5 <-predictions_data5 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw, copula) %>% 
  dplyr::summarise(cv_sum=sum(cv_sum), .groups = 'drop') %>% 
  dplyr::ungroup() 

predictions_data6<- read_excel("predictions_v2__clayton_ind.xlsx") 
predictions_data6 <-predictions_data6 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(copula="clayton_ind") %>%
  dplyr::group_by(decade, draw, copula) %>% 
  dplyr::summarise(cv_sum=sum(cv_sum), .groups = 'drop') %>% 
  dplyr::ungroup()  

predictions_data<-rbind.fill(predictions_data1, predictions_data2, predictions_data3, predictions_data4, predictions_data5, predictions_data6)
  
predictions_data<-  predictions_data %>% 
  dplyr::left_join(full_closure, by="draw") %>% 
  dplyr::mutate(perc_diff_full_closure=cv_sum/cv_sum_closure)

#predictions_data<- rbind.fill(predictions_data, baseline_stats)
ggplot(predictions_data, aes(x=copula, y=perc_diff_full_closure)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV/CV_2020", label=comma) + 
  facet_wrap(~ decade) + theme(axis.text.x = element_text(angle = 45,  hjust=1))

```
<div style="margin-bottom:50px;">
</div>

#### Clayton (independent catch)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
baseline_stats<- calib_data %>% 
  dplyr::select(cod_keep_trip, hadd_keep_trip, draw, estimated_trips) %>% 
  dplyr::mutate(decade = 0)

predictions_data<- read_excel("predictions_v2__clayton_ind.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est), .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices,
                cv_sum_inv=-cv_sum,
                cv_trip=cv_sum/ntrips_sum,
                cod_keep_trip=cod_keep_sum/ntrips_sum,
                hadd_keep_trip=hadd_keep_sum/ntrips_sum) 

#predictions_data<- rbind.fill(predictions_data, baseline_stats)


plot1<-ggplot(predictions_data, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)

# 
# plot1<-ggplot(predictions_data, aes(x=decade, y=cod_keep_trip)) + 
#   geom_violin() + geom_boxplot(width=0.1)+
#   scale_y_continuous(name="", label=comma)
# 
# plot2<-ggplot(predictions_data, aes(x=decade, y=hadd_keep_trip)) + 
#   geom_violin() + geom_boxplot(width=0.1)+
#   scale_y_continuous(name="", label=comma) 
# 
# grid.arrange(plot1, plot2, ncol=2)

```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```


<div style="margin-bottom:50px;">
</div>

Total CV and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total CV", label=comma)

# plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum_inv)) + 
#   geom_violin() + geom_boxplot(width=0.1)+
#   scale_y_continuous("Angler welfare ($)", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data, aes(x=decade, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```


#### Clayton (correlated catch)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__clayton_corr.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)


plot1<-ggplot(predictions_data, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Total CV and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total CV", label=comma)

# plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum_inv)) + 
#   geom_violin() + geom_boxplot(width=0.1)+
#   scale_y_continuous("Angler welfare ($)", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data, aes(x=decade, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```


#### Gumbel (independent catch)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__gumbel_ind.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum), 
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)


plot1<-ggplot(predictions_data, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Total CV and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total CV", label=comma)

# plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum_inv)) + 
#   geom_violin() + geom_boxplot(width=0.1)+
#   scale_y_continuous("Angler welfare ($)", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data, aes(x=decade, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

#### Gumbel (correlated catch)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__gumbel_corr.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)


plot1<-ggplot(predictions_data, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Total CV and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total CV", label=comma)

# plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum_inv)) + 
#   geom_violin() + geom_boxplot(width=0.1)+
#   scale_y_continuous("Angler welfare ($)", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data, aes(x=decade, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

#### Frank (independent catch)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__frank_ind.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)


plot1<-ggplot(predictions_data, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Total CV and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total CV", label=comma)

# plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum_inv)) + 
#   geom_violin() + geom_boxplot(width=0.1)+
#   scale_y_continuous("Angler welfare ($)", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data, aes(x=decade, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

#### Frank (correlated catch)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__frank_corr.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)


plot1<-ggplot(predictions_data, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Total CV and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total CV", label=comma)

# plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum_inv)) + 
#   geom_violin() + geom_boxplot(width=0.1)+
#   scale_y_continuous("Angler welfare ($)", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data, aes(x=decade, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

#### Plackett (independent catch)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__plackett_ind.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)


plot1<-ggplot(predictions_data, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Total CV and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total CV", label=comma)

# plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum_inv)) + 
#   geom_violin() + geom_boxplot(width=0.1)+
#   scale_y_continuous("Angler welfare ($)", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data, aes(x=decade, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```


#### Plackett (correlated catch)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__plackett_corr.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)


plot1<-ggplot(predictions_data, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Total CV and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total CV", label=comma)

# plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum_inv)) + 
#   geom_violin() + geom_boxplot(width=0.1)+
#   scale_y_continuous("Angler welfare ($)", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data, aes(x=decade, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```



#### Gaussian (independent catch)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__gaussian_ind.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)


plot1<-ggplot(predictions_data, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Total CV and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total CV", label=comma)

# plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum_inv)) + 
#   geom_violin() + geom_boxplot(width=0.1)+
#   scale_y_continuous("Angler welfare ($)", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data, aes(x=decade, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```



#### Gaussian (correlated catch)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__gaussian_corr.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::group_by(decade, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)


plot1<-ggplot(predictions_data, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Total CV and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total CV", label=comma)

# plot1<-ggplot(predictions_data, aes(x=decade, y=cv_sum_inv)) + 
#   geom_violin() + geom_boxplot(width=0.1)+
#   scale_y_continuous("Angler welfare ($)", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data, aes(x=decade, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data, aes(x=decade, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```




#### All copulas (correlated catch, decade=1)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data1<- read_excel("predictions_v2__frank_corr.xlsx") 
predictions_data1 <-predictions_data1 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==1)

predictions_data2<- read_excel("predictions_v2__clayton_corr.xlsx") 
predictions_data2 <-predictions_data2 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==1)

predictions_data3<- read_excel("predictions_v2__gumbel_corr.xlsx") 
predictions_data3 <-predictions_data3 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==1)

predictions_data8<- read_excel("predictions_v2__plackett_corr.xlsx") 
predictions_data8 <-predictions_data8 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==1)

predictions_data9<- read_excel("predictions_v2__gaussian_corr.xlsx") 
predictions_data9 <-predictions_data9 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==1)


predictions_data4<-rbind(predictions_data1, predictions_data2, predictions_data3, predictions_data8, predictions_data9)

predictions_data5<- predictions_data4  %>%
  dplyr::group_by(copula, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)


predictions_data1a<- read_excel("predictions_v2__frank_ind.xlsx") 
predictions_data1a <-predictions_data1a %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==1)

predictions_data2a<- read_excel("predictions_v2__clayton_ind.xlsx") 
predictions_data2a <-predictions_data2a %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==1)

predictions_data3a<- read_excel("predictions_v2__gumbel_ind.xlsx") 
predictions_data3a <-predictions_data3a %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==1)

predictions_data8a<- read_excel("predictions_v2__plackett_ind.xlsx") 
predictions_data8a <-predictions_data8a %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==1)

predictions_data9a<- read_excel("predictions_v2__gaussian_ind.xlsx") 
predictions_data9a <-predictions_data9a %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==1)

predictions_data4a<-rbind( predictions_data1a, predictions_data2a, predictions_data3a, predictions_data8a, predictions_data9a)

predictions_data5a<- predictions_data4a  %>%
  dplyr::group_by(copula, draw) %>% 
 dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices) %>%
  dplyr::mutate(copula="_ind")  



predictions_data5b<-rbind.fill( predictions_data5a, predictions_data5)

plot1<-ggplot(predictions_data5b, aes(x=copula, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data5b, aes(x=copula, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data5b, aes(x=copula, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data5b, aes(x=copula, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Total CV and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data5b, aes(x=copula, y=cv_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total CV", label=comma)

plot2<- ggplot(predictions_data5b, aes(x=copula, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
# predictions_data1a<- read_excel("predictions_v2__frank_ind.xlsx") 
# predictions_data1a <-predictions_data1a %>% 
#   mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
#   filter(decade==1)
# 
# predictions_data2a<- read_excel("predictions_v2__clayton_ind.xlsx") 
# predictions_data2a <-predictions_data2a %>% 
#   mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
#   filter(decade==1)
# 
# predictions_data3a<- read_excel("predictions_v2__gumbel_ind.xlsx") 
# predictions_data3a <-predictions_data3a %>% 
#   mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
#   filter(decade==1)
# 
# predictions_data8a<- read_excel("predictions_v2__plackett_ind.xlsx") 
# predictions_data8a <-predictions_data8a %>% 
#   mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
#   filter(decade==1)
# 
# predictions_data9a<- read_excel("predictions_v2__gaussian_ind.xlsx") 
# predictions_data9a <-predictions_data9a %>% 
#   mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
#   filter(decade==1)
# 
# predictions_data4a<-rbind( predictions_data1a, predictions_data2a, predictions_data3a, predictions_data8a, predictions_data9a)
# 
# predictions_data5a<- predictions_data4a  %>%
#   dplyr::group_by(copula, draw) %>% 
#  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
#                    hadd_keep_sum=sum(hadd_keep_sum),
#                    cod_catch_sum=sum(cod_catch_sum), 
#                    hadd_catch_sum=sum(hadd_catch_sum),
#                    cv_sum=sum(cv_sum),
#                    ntrips_sum=sum(ntrips_alt_sum),
#                    n_choices=sum(n_choice_occasions_sum),
#                    k_tau_keep_est=mean(k_tau_keep_est), 
#                    k_tau_catch_est=mean(k_tau_catch_est),
#                    .groups = 'drop') %>% 
#   dplyr::ungroup() %>% 
#   dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
#                 hadd_keep_i=hadd_keep_sum/n_choices,
#                 cod_catch_i=cod_catch_sum/n_choices,
#                 hadd_catch_i=hadd_catch_sum/n_choices,
#                 cv_i=cv_sum/n_choices) %>%
#   dplyr::mutate(copula="_ind")  
# 
# 
# 
# predictions_data5b<-rbind.fill( predictions_data5a, predictions_data5)

plot1<- ggplot(predictions_data5b, aes(x=copula, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data5b, aes(x=copula, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

#### All copulas (correlated catch, decade=4)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data1<- read_excel("predictions_v2__frank_corr.xlsx") 
predictions_data1 <-predictions_data1 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==4)

predictions_data2<- read_excel("predictions_v2__clayton_corr.xlsx") 
predictions_data2 <-predictions_data2 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==4)

predictions_data3<- read_excel("predictions_v2__gumbel_corr.xlsx") 
predictions_data3 <-predictions_data3 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==4)

predictions_data8<- read_excel("predictions_v2__plackett_corr.xlsx") 
predictions_data8 <-predictions_data8 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==4)

predictions_data9<- read_excel("predictions_v2__gaussian_corr.xlsx") 
predictions_data9 <-predictions_data9 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==4)


predictions_data4<-rbind(predictions_data1, predictions_data2, predictions_data3, predictions_data8, predictions_data9)

predictions_data5<- predictions_data4  %>%
  dplyr::group_by(copula, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)


predictions_data1a<- read_excel("predictions_v2__frank_ind.xlsx") 
predictions_data1a <-predictions_data1a %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==4)

predictions_data2a<- read_excel("predictions_v2__clayton_ind.xlsx") 
predictions_data2a <-predictions_data2a %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==4)

predictions_data3a<- read_excel("predictions_v2__gumbel_ind.xlsx") 
predictions_data3a <-predictions_data3a %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==4)

predictions_data8a<- read_excel("predictions_v2__plackett_ind.xlsx") 
predictions_data8a <-predictions_data8a %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==4)

predictions_data9a<- read_excel("predictions_v2__gaussian_ind.xlsx") 
predictions_data9a <-predictions_data9a %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==4)

predictions_data4a<-rbind( predictions_data1a, predictions_data2a, predictions_data3a, predictions_data8a, predictions_data9a)

predictions_data5a<- predictions_data4a  %>%
  dplyr::group_by(copula, draw) %>% 
 dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices) %>%
  dplyr::mutate(copula="_ind")  



predictions_data5b<-rbind.fill( predictions_data5a, predictions_data5)

plot1<-ggplot(predictions_data5b, aes(x=copula, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data5b, aes(x=copula, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data5b, aes(x=copula, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data5b, aes(x=copula, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Total CV and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data5b, aes(x=copula, y=cv_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total CV", label=comma)

plot2<- ggplot(predictions_data5b, aes(x=copula, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
# predictions_data1a<- read_excel("predictions_v2__frank_ind.xlsx") 
# predictions_data1a <-predictions_data1a %>% 
#   mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
#   filter(decade==4)
# 
# predictions_data2a<- read_excel("predictions_v2__clayton_ind.xlsx") 
# predictions_data2a <-predictions_data2a %>% 
#   mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
#   filter(decade==4)
# 
# predictions_data3a<- read_excel("predictions_v2__gumbel_ind.xlsx") 
# predictions_data3a <-predictions_data3a %>% 
#   mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
#   filter(decade==4)
# 
# predictions_data8a<- read_excel("predictions_v2__plackett_ind.xlsx") 
# predictions_data8a <-predictions_data8a %>% 
#   mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
#   filter(decade==4)
# 
# predictions_data9a<- read_excel("predictions_v2__gaussian_ind.xlsx") 
# predictions_data9a <-predictions_data9a %>% 
#   mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
#   filter(decade==4)
# 
# predictions_data4a<-rbind( predictions_data1a, predictions_data2a, predictions_data3a, predictions_data8a, predictions_data9a)
# 
# predictions_data5a<- predictions_data4a  %>%
#   dplyr::group_by(copula, draw) %>% 
#   dplyr::summarise(k_tau_keep_est=mean(k_tau_keep_est), 
#                    k_tau_catch_est=mean(k_tau_catch_est),
#                    .groups = 'drop')  %>%
#   dplyr::mutate(copula="_ind") 
# 
# 
# predictions_data5b<-rbind.fill( predictions_data5a, predictions_data5)

plot1<- ggplot(predictions_data5b, aes(x=copula, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data5b, aes(x=copula, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

#### All copulas (correlated catch, decade=8)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data1<- read_excel("predictions_v2__frank_corr.xlsx") 
predictions_data1 <-predictions_data1 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==8)

predictions_data2<- read_excel("predictions_v2__clayton_corr.xlsx") 
predictions_data2 <-predictions_data2 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==8)

predictions_data3<- read_excel("predictions_v2__gumbel_corr.xlsx") 
predictions_data3 <-predictions_data3 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==8)

predictions_data8<- read_excel("predictions_v2__plackett_corr.xlsx") 
predictions_data8 <-predictions_data8 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==8)

predictions_data9<- read_excel("predictions_v2__gaussian_corr.xlsx") 
predictions_data9 <-predictions_data9 %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==8)


predictions_data4<-rbind(predictions_data1, predictions_data2, predictions_data3, predictions_data8, predictions_data9)

predictions_data5<- predictions_data4  %>%
  dplyr::group_by(copula, draw) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices)


predictions_data1a<- read_excel("predictions_v2__frank_ind.xlsx") 
predictions_data1a <-predictions_data1a %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==8)

predictions_data2a<- read_excel("predictions_v2__clayton_ind.xlsx") 
predictions_data2a <-predictions_data2a %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==8)

predictions_data3a<- read_excel("predictions_v2__gumbel_ind.xlsx") 
predictions_data3a <-predictions_data3a %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==8)

predictions_data8a<- read_excel("predictions_v2__plackett_ind.xlsx") 
predictions_data8a <-predictions_data8a %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==8)

predictions_data9a<- read_excel("predictions_v2__gaussian_ind.xlsx") 
predictions_data9a <-predictions_data9a %>% 
  mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
  filter(decade==8)

predictions_data4a<-rbind( predictions_data1a, predictions_data2a, predictions_data3a, predictions_data8a, predictions_data9a)

predictions_data5a<- predictions_data4a  %>%
  dplyr::group_by(copula, draw) %>% 
 dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est),
                   .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices) %>%
  dplyr::mutate(copula="_ind")  



predictions_data5b<-rbind.fill( predictions_data5a, predictions_data5)

plot1<-ggplot(predictions_data5b, aes(x=copula, y=cod_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="cod keep per choice occasion", label=comma)

plot2<-ggplot(predictions_data5b, aes(x=copula, y=hadd_keep_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) 

grid.arrange(plot1, plot2, ncol=2)
```
<div style="margin-bottom:50px;">
</div>

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data5b, aes(x=copula, y=cod_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)

plot2<- ggplot(predictions_data5b, aes(x=copula, y=hadd_catch_i)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Total CV and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data5b, aes(x=copula, y=cv_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total CV", label=comma)

plot2<- ggplot(predictions_data5b, aes(x=copula, y=ntrips_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)

grid.arrange(plot1, plot2, ncol=2)
```

<div style="margin-bottom:50px;">
</div>

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
# predictions_data1a<- read_excel("predictions_v2__frank_ind.xlsx") 
# predictions_data1a <-predictions_data1a %>% 
#   mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
#   filter(decade==8)
# 
# predictions_data2a<- read_excel("predictions_v2__clayton_ind.xlsx") 
# predictions_data2a <-predictions_data2a %>% 
#   mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
#   filter(decade==8)
# 
# predictions_data3a<- read_excel("predictions_v2__gumbel_ind.xlsx") 
# predictions_data3a <-predictions_data3a %>% 
#   mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
#   filter(decade==8)
# 
# predictions_data8a<- read_excel("predictions_v2__plackett_ind.xlsx") 
# predictions_data8a <-predictions_data8a %>% 
#   mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
#   filter(decade==8)
# 
# predictions_data9a<- read_excel("predictions_v2__gaussian_ind.xlsx") 
# predictions_data9a <-predictions_data9a %>% 
#   mutate(copula= str_replace_all(copula, "([_])", "")) %>% 
#   filter(decade==8)
# 
# predictions_data4a<-rbind( predictions_data1a, predictions_data2a, predictions_data3a, predictions_data8a, predictions_data9a)
# 
# predictions_data5a<- predictions_data4a  %>%
#   dplyr::group_by(copula, draw) %>% 
#   dplyr::summarise(k_tau_keep_est=mean(k_tau_keep_est), 
#                    k_tau_catch_est=mean(k_tau_catch_est),
#                    .groups = 'drop')  %>%
#   dplyr::mutate(copula="_ind") 
# 
# 
# predictions_data5b<-rbind.fill( predictions_data5a, predictions_data5)

plot1<- ggplot(predictions_data5b, aes(x=copula, y=k_tau_catch_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma)

plot2<- ggplot(predictions_data5b, aes(x=copula, y=k_tau_keep_est)) + 
  geom_violin() + geom_boxplot(width=0.1)+ geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma)

grid.arrange(plot1, plot2, ncol=2)

```

### {-}

### OLS meta-analaysis of simulation results
The following OLS regression uses as data the 10 sets of results above (5 copulas, each with independent and correlated catch).  

```{r echo=FALSE, fig.cap="OLS results of total monthly CV", out.width = '70%'}
knitr::include_graphics("figure/OLS meta-analysis monthly.png")
```

### Monthly fishery outcomes under climate-induced changes in catch-per-trip {.tabset}
For reference, here are the number of directed trips by mode and period (1st and 2nd half of month) in 2020.  

<!--```{r echo = FALSE, results = 'asis'}
directed_trips_base<-data.frame(read_excel("directed_trips.xlsx"))
directed_trips_base<-directed_trips_base %>% 
  dplyr::select(-number_trips_to_sample, -percent_of_trips, -period2) %>% 
  dplyr::arrange(month, period, mode1)
kable(directed_trips_base, caption = "Number of directed trips for cod and haddock in 2020.")
``` -->

```{r echo=FALSE, fig.cap="MRIP point estimates of directed trips in 2020 by bi-monthly period", out.width = '70%'}
knitr::include_graphics("figure/dtrips1.png")
```
Each tab below contains projected fishery outcomes at the monthly level based on input data from alternative copula models. 

#### Clayton (independent catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__clayton_ind.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

#### Clayton (correlated catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__clayton_corr.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

#### Gumbel (independent catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__gumbel_ind.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

#### Gumbel (correlated catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__gumbel_corr.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

#### Frank (independent catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__frank_ind.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

#### Frank (correlated catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__frank_corr.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

#### Plackett (independent catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__plackett_ind.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```


#### Plackett (correlated catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__plackett_corr.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```



#### Gaussian (independent catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__gaussian_ind.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```




#### Gaussian (correlated catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__gaussian_corr.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

### {-}
### MC simulation #2a - annual fishery outcomes with alternative cod open seasons {.tabset}
In these simulations, I vary the cod open season across different months of the year. 

The baseline (2020) open season for cod was Sep. 15-30 for private boat and September 7-October 8 for for-hire. Because the model time-step is bi-monthly (two periods per month: 1st half, 2nd half), I set the baseline private boat open season to the 2nd half of September and the baseline for-hire season to the 1st and 2nd half of September. Haddock was open all months in the baseline except March and the first half of April, when there was no directed trips. 

I specified alternative cod open seasons by month for May, June, July, August, and October. To do this, I open the 2nd half of the month for private boat mode, and I open the 1st and 2nd half of the month for the for-hire mode. 

In these simulations I use independent and correlated catch-per-trip data from the clayton copula model.

CV results below show the difference in total CV between cod open season of September and cod open season  occurring an alternative month.

#### CV difference - Independent (decade=1)
```{r echo = FALSE}
predictions_data_base<- read_excel("predictions_v2__clayton_ind.xlsx") 
predictions_data_base<-predictions_data_base %>% 
  dplyr::mutate(closure_month=9) %>% 
  dplyr::mutate(decade=as.character(decade))

predictions_data<- read_excel("predictions__clayton_ind_cod_open_season.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::bind_rows(predictions_data_base)  %>% 
  dplyr::group_by(decade, draw, closure_month) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est), .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices) %>% 
  dplyr::rename(open_month=closure_month)
  
predictions_test_9<-predictions_data %>% 
   dplyr::filter(open_month %in% c(9)) %>% 
   dplyr::filter(decade==1) %>% 
   dplyr::select(cv_sum, draw) %>% 
   dplyr::rename(cv_sum_9=cv_sum) 

predictions_test_5<-predictions_data %>% 
   dplyr::filter(open_month %in% c(5)) %>% 
   dplyr::filter(decade==1) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_5=cv_sum) %>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_5) %>% 
   dplyr::select(draw, diff_cv, open_month)
 
predictions_test_6<-predictions_data %>% 
   dplyr::filter(open_month %in% c(6)) %>% 
   dplyr::filter(decade==1) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_6=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_6) %>% 
   dplyr::select(draw, diff_cv, open_month)
 

predictions_test_7<-predictions_data %>% 
   dplyr::filter(open_month %in% c(7)) %>% 
   dplyr::filter(decade==1) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_7=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_7) %>% 
   dplyr::select(draw, diff_cv, open_month)
   
predictions_test_8<-predictions_data %>% 
   dplyr::filter(open_month %in% c(8)) %>% 
   dplyr::filter(decade==1) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_8=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_8) %>% 
   dplyr::select(draw, diff_cv, open_month)
    
predictions_test_10<-predictions_data %>% 
   dplyr::filter(open_month %in% c(10)) %>% 
   dplyr::filter(decade==1) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_10=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_10) %>% 
   dplyr::select(draw, diff_cv, open_month)

predictions_test<-rbind(predictions_test_10, predictions_test_8, predictions_test_7,predictions_test_6, predictions_test_5 )

predictions_test<-predictions_test %>% 
    mutate(open_month=as.factor(open_month))

ggplot(predictions_test, aes(x=open_month, y=diff_cv)) +
  geom_violin() + 
  geom_boxplot(width=0.1)+
  labs(x="Cod fishery open month", y=expression("CV"["open Sept."]-"CV"["open X"])) +
  ggtitle("Difference in total CV relative to baseline")
``` 

#### CV difference - Independent (decade=5)
```{r echo = FALSE}
predictions_data_base<- read_excel("predictions_v2__clayton_ind.xlsx") 
predictions_data_base<-predictions_data_base %>% 
  dplyr::mutate(closure_month=9) %>% 
  dplyr::mutate(decade=as.character(decade))

predictions_data<- read_excel("predictions__clayton_ind_cod_open_season.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::bind_rows(predictions_data_base)  %>% 
  dplyr::group_by(decade, draw, closure_month) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est), .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices) %>% 
  dplyr::rename(open_month=closure_month)
  
predictions_test_9<-predictions_data %>% 
   dplyr::filter(open_month %in% c(9)) %>% 
   dplyr::filter(decade==5) %>% 
   dplyr::select(cv_sum, draw) %>% 
   dplyr::rename(cv_sum_9=cv_sum) 

predictions_test_5<-predictions_data %>% 
   dplyr::filter(open_month %in% c(5)) %>% 
   dplyr::filter(decade==5) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_5=cv_sum) %>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_5) %>% 
   dplyr::select(draw, diff_cv, open_month)
 
predictions_test_6<-predictions_data %>% 
   dplyr::filter(open_month %in% c(6)) %>% 
   dplyr::filter(decade==5) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_6=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_6) %>% 
   dplyr::select(draw, diff_cv, open_month)
 

predictions_test_7<-predictions_data %>% 
   dplyr::filter(open_month %in% c(7)) %>% 
   dplyr::filter(decade==5) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_7=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_7) %>% 
   dplyr::select(draw, diff_cv, open_month)
   
predictions_test_8<-predictions_data %>% 
   dplyr::filter(open_month %in% c(8)) %>% 
   dplyr::filter(decade==5) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_8=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_8) %>% 
   dplyr::select(draw, diff_cv, open_month)
    
predictions_test_10<-predictions_data %>% 
   dplyr::filter(open_month %in% c(10)) %>% 
   dplyr::filter(decade==5) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_10=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_10) %>% 
   dplyr::select(draw, diff_cv, open_month)

predictions_test<-rbind(predictions_test_10, predictions_test_8, predictions_test_7,predictions_test_6, predictions_test_5 )

predictions_test<-predictions_test %>% 
    mutate(open_month=as.factor(open_month))

ggplot(predictions_test, aes(x=open_month, y=diff_cv)) +
  geom_violin() + 
  geom_boxplot(width=0.1)+
  labs(x="Cod fishery open month", y=expression("CV"["open Sept."]-"CV"["open X"])) +
  ggtitle("Difference in total CV relative to baseline")
```

#### CV difference - Independent (decade=8)
```{r echo = FALSE}
predictions_data_base<- read_excel("predictions_v2__clayton_ind.xlsx") 
predictions_data_base<-predictions_data_base %>% 
  dplyr::mutate(closure_month=9) %>% 
  dplyr::mutate(decade=as.character(decade))

predictions_data<- read_excel("predictions__clayton_ind_cod_open_season.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::bind_rows(predictions_data_base)  %>% 
  dplyr::group_by(decade, draw, closure_month) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est), .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices) %>% 
  dplyr::rename(open_month=closure_month)
  
predictions_test_9<-predictions_data %>% 
   dplyr::filter(open_month %in% c(9)) %>% 
   dplyr::filter(decade==8) %>% 
   dplyr::select(cv_sum, draw) %>% 
   dplyr::rename(cv_sum_9=cv_sum) 

predictions_test_5<-predictions_data %>% 
   dplyr::filter(open_month %in% c(5)) %>% 
   dplyr::filter(decade==8) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_5=cv_sum) %>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_5) %>% 
   dplyr::select(draw, diff_cv, open_month)
 
predictions_test_6<-predictions_data %>% 
   dplyr::filter(open_month %in% c(6)) %>% 
   dplyr::filter(decade==8) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_6=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_6) %>% 
   dplyr::select(draw, diff_cv, open_month)
 

predictions_test_7<-predictions_data %>% 
   dplyr::filter(open_month %in% c(7)) %>% 
   dplyr::filter(decade==8) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_7=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_7) %>% 
   dplyr::select(draw, diff_cv, open_month)
   
predictions_test_8<-predictions_data %>% 
   dplyr::filter(open_month %in% c(8)) %>% 
   dplyr::filter(decade==8) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_8=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_8) %>% 
   dplyr::select(draw, diff_cv, open_month)
    
predictions_test_10<-predictions_data %>% 
   dplyr::filter(open_month %in% c(10)) %>% 
   dplyr::filter(decade==8) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_10=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_10) %>% 
   dplyr::select(draw, diff_cv, open_month)

predictions_test<-rbind(predictions_test_10, predictions_test_8, predictions_test_7,predictions_test_6, predictions_test_5 )

predictions_test<-predictions_test %>% 
    mutate(open_month=as.factor(open_month))

ggplot(predictions_test, aes(x=open_month, y=diff_cv)) +
  geom_violin() + 
  geom_boxplot(width=0.1)+
  labs(x="Cod fishery open month", y=expression("CV"["open Sept."]-"CV"["open X"])) +
  ggtitle("Difference in total CV relative to baseline")
```

#### CV difference - Correlated (decade=1)
```{r echo = FALSE}
predictions_data_base<- read_excel("predictions_v2__clayton_corr.xlsx") 
predictions_data_base<-predictions_data_base %>% 
  dplyr::mutate(closure_month=9) %>% 
  dplyr::mutate(decade=as.character(decade))

predictions_data<- read_excel("predictions__clayton_corr_cod_open_season.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::bind_rows(predictions_data_base)  %>% 
  dplyr::group_by(decade, draw, closure_month) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est), .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices) %>% 
  dplyr::rename(open_month=closure_month)
  
predictions_test_9<-predictions_data %>% 
   dplyr::filter(open_month %in% c(9)) %>% 
   dplyr::filter(decade==1) %>% 
   dplyr::select(cv_sum, draw) %>% 
   dplyr::rename(cv_sum_9=cv_sum) 

predictions_test_5<-predictions_data %>% 
   dplyr::filter(open_month %in% c(5)) %>% 
   dplyr::filter(decade==1) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_5=cv_sum) %>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_5) %>% 
   dplyr::select(draw, diff_cv, open_month)
 
predictions_test_6<-predictions_data %>% 
   dplyr::filter(open_month %in% c(6)) %>% 
   dplyr::filter(decade==1) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_6=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_6) %>% 
   dplyr::select(draw, diff_cv, open_month)
 

predictions_test_7<-predictions_data %>% 
   dplyr::filter(open_month %in% c(7)) %>% 
   dplyr::filter(decade==1) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_7=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_7) %>% 
   dplyr::select(draw, diff_cv, open_month)
   
predictions_test_8<-predictions_data %>% 
   dplyr::filter(open_month %in% c(8)) %>% 
   dplyr::filter(decade==1) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_8=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_8) %>% 
   dplyr::select(draw, diff_cv, open_month)
    
predictions_test_10<-predictions_data %>% 
   dplyr::filter(open_month %in% c(10)) %>% 
   dplyr::filter(decade==1) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_10=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_10) %>% 
   dplyr::select(draw, diff_cv, open_month)

predictions_test<-rbind(predictions_test_10, predictions_test_8, predictions_test_7,predictions_test_6, predictions_test_5 )

predictions_test<-predictions_test %>% 
    mutate(open_month=as.factor(open_month))

ggplot(predictions_test, aes(x=open_month, y=diff_cv)) +
  geom_violin() + 
  geom_boxplot(width=0.1)+
  labs(x="Cod fishery open month", y=expression("CV"["open Sept."]-"CV"["open X"])) +
  ggtitle("Difference in total CV relative to baseline")
``` 

#### CV difference - Correlated (decade=5)
```{r echo = FALSE}
predictions_data_base<- read_excel("predictions_v2__clayton_corr.xlsx") 
predictions_data_base<-predictions_data_base %>% 
  dplyr::mutate(closure_month=9) %>% 
  dplyr::mutate(decade=as.character(decade))

predictions_data<- read_excel("predictions__clayton_corr_cod_open_season.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::bind_rows(predictions_data_base)  %>% 
  dplyr::group_by(decade, draw, closure_month) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est), .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices) %>% 
  dplyr::rename(open_month=closure_month)
  
predictions_test_9<-predictions_data %>% 
   dplyr::filter(open_month %in% c(9)) %>% 
   dplyr::filter(decade==5) %>% 
   dplyr::select(cv_sum, draw) %>% 
   dplyr::rename(cv_sum_9=cv_sum) 

predictions_test_5<-predictions_data %>% 
   dplyr::filter(open_month %in% c(5)) %>% 
   dplyr::filter(decade==5) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_5=cv_sum) %>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_5) %>% 
   dplyr::select(draw, diff_cv, open_month)
 
predictions_test_6<-predictions_data %>% 
   dplyr::filter(open_month %in% c(6)) %>% 
   dplyr::filter(decade==5) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_6=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_6) %>% 
   dplyr::select(draw, diff_cv, open_month)
 

predictions_test_7<-predictions_data %>% 
   dplyr::filter(open_month %in% c(7)) %>% 
   dplyr::filter(decade==5) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_7=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_7) %>% 
   dplyr::select(draw, diff_cv, open_month)
   
predictions_test_8<-predictions_data %>% 
   dplyr::filter(open_month %in% c(8)) %>% 
   dplyr::filter(decade==5) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_8=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_8) %>% 
   dplyr::select(draw, diff_cv, open_month)
    
predictions_test_10<-predictions_data %>% 
   dplyr::filter(open_month %in% c(10)) %>% 
   dplyr::filter(decade==5) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_10=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_10) %>% 
   dplyr::select(draw, diff_cv, open_month)

predictions_test<-rbind(predictions_test_10, predictions_test_8, predictions_test_7,predictions_test_6, predictions_test_5 )

predictions_test<-predictions_test %>% 
    mutate(open_month=as.factor(open_month))

ggplot(predictions_test, aes(x=open_month, y=diff_cv)) +
  geom_violin() + 
  geom_boxplot(width=0.1)+
  labs(x="Cod fishery open month", y=expression("CV"["open Sept."]-"CV"["open X"])) +
  ggtitle("Difference in total CV relative to baseline")
```

#### CV difference - Correlated (decade=8)
```{r echo = FALSE}
predictions_data_base<- read_excel("predictions_v2__clayton_corr.xlsx") 
predictions_data_base<-predictions_data_base %>% 
  dplyr::mutate(closure_month=9) %>% 
  dplyr::mutate(decade=as.character(decade))

predictions_data<- read_excel("predictions__clayton_corr_cod_open_season.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::bind_rows(predictions_data_base)  %>% 
  dplyr::group_by(decade, draw, closure_month) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est), .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices) %>% 
  dplyr::rename(open_month=closure_month)
  
predictions_test_9<-predictions_data %>% 
   dplyr::filter(open_month %in% c(9)) %>% 
   dplyr::filter(decade==8) %>% 
   dplyr::select(cv_sum, draw) %>% 
   dplyr::rename(cv_sum_9=cv_sum) 

predictions_test_5<-predictions_data %>% 
   dplyr::filter(open_month %in% c(5)) %>% 
   dplyr::filter(decade==8) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_5=cv_sum) %>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_5) %>% 
   dplyr::select(draw, diff_cv, open_month)
 
predictions_test_6<-predictions_data %>% 
   dplyr::filter(open_month %in% c(6)) %>% 
   dplyr::filter(decade==8) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_6=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_6) %>% 
   dplyr::select(draw, diff_cv, open_month)
 

predictions_test_7<-predictions_data %>% 
   dplyr::filter(open_month %in% c(7)) %>% 
   dplyr::filter(decade==8) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_7=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_7) %>% 
   dplyr::select(draw, diff_cv, open_month)
   
predictions_test_8<-predictions_data %>% 
   dplyr::filter(open_month %in% c(8)) %>% 
   dplyr::filter(decade==8) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_8=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_8) %>% 
   dplyr::select(draw, diff_cv, open_month)
    
predictions_test_10<-predictions_data %>% 
   dplyr::filter(open_month %in% c(10)) %>% 
   dplyr::filter(decade==8) %>% 
   dplyr::select(cv_sum, draw, open_month) %>% 
   dplyr::rename(cv_sum_10=cv_sum)%>% 
   dplyr::left_join(predictions_test_9, by="draw") %>% 
   dplyr::mutate(diff_cv=cv_sum_9-cv_sum_10) %>% 
   dplyr::select(draw, diff_cv, open_month)

predictions_test<-rbind(predictions_test_10, predictions_test_8, predictions_test_7,predictions_test_6, predictions_test_5 )

predictions_test<-predictions_test %>% 
    mutate(open_month=as.factor(open_month))

ggplot(predictions_test, aes(x=open_month, y=diff_cv)) +
  geom_violin() + 
  geom_boxplot(width=0.1)+
  labs(x="Cod fishery open month", y=expression("CV"["open Sept."]-"CV"["open X"])) +
  ggtitle("Difference in total CV relative to baseline")
```

#### Full results - Clayton (independent catch)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data_base<- read_excel("predictions_v2__clayton_ind.xlsx") 
predictions_data_base<-predictions_data_base %>% 
  dplyr::mutate(closure_month=9) %>% 
  dplyr::mutate(decade=as.character(decade))

predictions_data<- read_excel("predictions__clayton_ind_cod_open_season.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::bind_rows(predictions_data_base)  %>% 
  dplyr::group_by(decade, draw, closure_month) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est), .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices) %>% 
  dplyr::rename(open_month=closure_month)



plot1<-ggplot(predictions_data, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot()+
  scale_y_continuous(name="cod keep per choice occasion", label=comma) +
  facet_wrap(~open_month, nrow = 2, labeller = labeller(open_month = 
    c("5" = "cod open May",
      "6" = "cod open June",
      "7" = "cod open July",
      "8" = "cod open Aug",
      "9" = "cod open Sept",
      "10" = "cod open Oct")))

plot2<-ggplot(predictions_data, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot()+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) +
  facet_wrap(~open_month, nrow = 2, labeller = labeller(open_month = 
    c("5" = "cod open May",
      "6" = "cod open June",
      "7" = "cod open July",
      "8" = "cod open Aug",
      "9" = "cod open Sept",
      "10" = "cod open Oct")))

grid.arrange(plot1, plot2, ncol=2)
```

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)+
  facet_wrap(~open_month, nrow = 2, labeller = labeller(open_month = 
    c("5" = "cod open May",
      "6" = "cod open June",
      "7" = "cod open July",
      "8" = "cod open Aug",
      "9" = "cod open Sept",
      "10" = "cod open Oct")))

plot2<- ggplot(predictions_data, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)+
  facet_wrap(~open_month, nrow = 2, labeller = labeller(open_month = 
    c("5" = "cod open May",
      "6" = "cod open June",
      "7" = "cod open July",
      "8" = "cod open Aug",
      "9" = "cod open Sept",
      "10" = "cod open Oct")))

grid.arrange(plot1, plot2, ncol=2)
```

CV per choice occasion and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous("CV per choice occasion", label=comma)+
  facet_wrap(~open_month, nrow = 2, labeller = labeller(open_month = 
    c("5" = "cod open May",
      "6" = "cod open June",
      "7" = "cod open July",
      "8" = "cod open Aug",
      "9" = "cod open Sept",
      "10" = "cod open Oct")))

plot2<- ggplot(predictions_data, aes(x=decade, y=ntrips_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)+
  facet_wrap(~open_month, nrow = 2, labeller = labeller(open_month = 
    c("5" = "cod open May",
      "6" = "cod open June",
      "7" = "cod open July",
      "8" = "cod open Aug",
      "9" = "cod open Sept",
      "10" = "cod open Oct")))

grid.arrange(plot1, plot2, ncol=2)
```

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data, aes(x=decade, y=k_tau_catch_est)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+ 
  geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma) +
  facet_wrap(~open_month, nrow = 2, labeller = labeller(open_month = 
    c("5" = "cod open May",
      "6" = "cod open June",
      "7" = "cod open July",
      "8" = "cod open Aug",
      "9" = "cod open Sept",
      "10" = "cod open Oct")))

predictions_data_keep_corr<-predictions_data %>% 
  dplyr::filter(!is.na(k_tau_keep_est))

plot2<- ggplot(predictions_data_keep_corr, aes(x=decade, y=k_tau_keep_est)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+ 
  geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma) +
  facet_wrap(~open_month, nrow = 2, labeller = labeller(open_month = 
    c("5" = "cod open May",
      "6" = "cod open June",
      "7" = "cod open July",
      "8" = "cod open Aug",
      "9" = "cod open Sept",
      "10" = "cod open Oct")))

grid.arrange(plot1, plot2, ncol=2)
```

#### Full results - Clayton (correlated catch)
Cod and haddock keep per choice occasion:

```{r echo = FALSE}
predictions_data_base<- read_excel("predictions_v2__clayton_corr.xlsx") 
predictions_data_base<-predictions_data_base %>% 
  dplyr::mutate(closure_month=9) %>% 
  dplyr::mutate(decade=as.character(decade))

predictions_data<- read_excel("predictions__clayton_corr_cod_open_season.xlsx") 

predictions_data<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::bind_rows(predictions_data_base)  %>% 
  dplyr::group_by(decade, draw, closure_month) %>% 
  dplyr::summarise(cod_keep_sum=sum(cod_keep_sum), 
                   hadd_keep_sum=sum(hadd_keep_sum),
                   cod_catch_sum=sum(cod_catch_sum), 
                   hadd_catch_sum=sum(hadd_catch_sum),
                   cv_sum=sum(cv_sum),
                   ntrips_sum=sum(ntrips_alt_sum),
                   n_choices=sum(n_choice_occasions_sum),
                   k_tau_keep_est=mean(k_tau_keep_est), 
                   k_tau_catch_est=mean(k_tau_catch_est), .groups = 'drop') %>% 
  dplyr::ungroup() %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choices,
                hadd_keep_i=hadd_keep_sum/n_choices,
                cod_catch_i=cod_catch_sum/n_choices,
                hadd_catch_i=hadd_catch_sum/n_choices,
                cv_i=cv_sum/n_choices) %>% 
  dplyr::rename(open_month=closure_month)



plot1<-ggplot(predictions_data, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot()+
  scale_y_continuous(name="cod keep per choice occasion", label=comma) +
  facet_wrap(~open_month, nrow = 2, labeller = labeller(open_month = 
    c("5" = "cod open May",
      "6" = "cod open June",
      "7" = "cod open July",
      "8" = "cod open Aug",
      "9" = "cod open Sept",
      "10" = "cod open Oct")))

plot2<-ggplot(predictions_data, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot()+
  scale_y_continuous(name="haddock keep per choice occasion", label=comma) +
  facet_wrap(~open_month, nrow = 2, labeller = labeller(open_month = 
    c("5" = "cod open May",
      "6" = "cod open June",
      "7" = "cod open July",
      "8" = "cod open Aug",
      "9" = "cod open Sept",
      "10" = "cod open Oct")))

grid.arrange(plot1, plot2, ncol=2)
```

Cod and haddock catch per choice occasion:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous("Cod catch per choice occasion", label=comma)+
  facet_wrap(~open_month, nrow = 2, labeller = labeller(open_month = 
    c("5" = "cod open May",
      "6" = "cod open June",
      "7" = "cod open July",
      "8" = "cod open Aug",
      "9" = "cod open Sept",
      "10" = "cod open Oct")))

plot2<- ggplot(predictions_data, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous("Haddock catch per choice occasion", label=comma)+
  facet_wrap(~open_month, nrow = 2, labeller = labeller(open_month = 
    c("5" = "cod open May",
      "6" = "cod open June",
      "7" = "cod open July",
      "8" = "cod open Aug",
      "9" = "cod open Sept",
      "10" = "cod open Oct")))

grid.arrange(plot1, plot2, ncol=2)
```

CV per choice occasion and number of trips:

```{r echo = FALSE}
plot1<-ggplot(predictions_data, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous("CV per choice occasion", label=comma)+
  facet_wrap(~open_month, nrow = 2, labeller = labeller(open_month = 
    c("5" = "cod open May",
      "6" = "cod open June",
      "7" = "cod open July",
      "8" = "cod open Aug",
      "9" = "cod open Sept",
      "10" = "cod open Oct")))

plot2<- ggplot(predictions_data, aes(x=decade, y=ntrips_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous("Total number of trips", label=comma)+
  facet_wrap(~open_month, nrow = 2, labeller = labeller(open_month = 
    c("5" = "cod open May",
      "6" = "cod open June",
      "7" = "cod open July",
      "8" = "cod open Aug",
      "9" = "cod open Sept",
      "10" = "cod open Oct")))

grid.arrange(plot1, plot2, ncol=2)
```

Correlation in catch and keep of cod and haddock per choice occasion (kendall's tau-b):

```{r echo = FALSE}
plot1<- ggplot(predictions_data, aes(x=decade, y=k_tau_catch_est)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+ 
  geom_hline(yintercept=0, linetype="dashed", color = "red")+
  scale_y_continuous("Correlation in catch-per-choice occasion", label=comma) +
  facet_wrap(~open_month, nrow = 2, labeller = labeller(open_month = 
    c("5" = "cod open May",
      "6" = "cod open June",
      "7" = "cod open July",
      "8" = "cod open Aug",
      "9" = "cod open Sept",
      "10" = "cod open Oct")))

predictions_data_keep_corr<-predictions_data %>% 
  dplyr::filter(!is.na(k_tau_keep_est))

plot2<- ggplot(predictions_data_keep_corr, aes(x=decade, y=k_tau_keep_est)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+ 
  geom_hline(yintercept=0, linetype="dashed", color = "red")+ 
  scale_y_continuous("Correlation in keep-per-choice occasion", label=comma) +
  facet_wrap(~open_month, nrow = 2, labeller = labeller(open_month = 
    c("5" = "cod open May",
      "6" = "cod open June",
      "7" = "cod open July",
      "8" = "cod open Aug",
      "9" = "cod open Sept",
      "10" = "cod open Oct")))

grid.arrange(plot1, plot2, ncol=2)
```

### {-}

### MC simulation #2b - monthly fishery outcomes with alternative cod open seasons {.tabset}
In these simulations, I vary the cod open season across different months of the year. The results here come from #2a above but are presented at the monthly level. 

#### May open (correlated catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__clayton_corr_cod_open_season.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw) %>% 
  dplyr::filter(closure_month==5)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

#### June open (correlated catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__clayton_corr_cod_open_season.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw) %>% 
  dplyr::filter(closure_month==6)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

#### July open (correlated catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__clayton_corr_cod_open_season.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw) %>% 
  dplyr::filter(closure_month==7)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

#### August open (correlated catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__clayton_corr_cod_open_season.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw) %>% 
  dplyr::filter(closure_month==8)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

#### September open (baseline results) (correlated catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__clayton_corr.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```


#### October open (correlated catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__clayton_corr_cod_open_season.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw) %>% 
  dplyr::filter(closure_month==10)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```






#### May open (independent catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__clayton_ind_cod_open_season.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw) %>% 
  dplyr::filter(closure_month==5)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

#### June open (independent catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__clayton_ind_cod_open_season.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw) %>% 
  dplyr::filter(closure_month==6)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

#### July open (independent catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__clayton_ind_cod_open_season.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw) %>% 
  dplyr::filter(closure_month==7)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

#### August open (independent catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__clayton_ind_cod_open_season.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw) %>% 
  dplyr::filter(closure_month==8)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

#### September open (baseline results) (independent catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions_v2__clayton_ind.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```


#### October open (independent catch)
Number of trips by month:

```{r echo = FALSE}
predictions_data<- read_excel("predictions__clayton_ind_cod_open_season.xlsx") 

predictions_data_month_d1<-predictions_data %>% 
  dplyr::mutate(decade=as.character(decade)) %>% 
  dplyr::mutate(cod_keep_i=cod_keep_sum/n_choice_occasions_sum,
                hadd_keep_i=hadd_keep_sum/n_choice_occasions_sum,
                cod_catch_i=cod_catch_sum/n_choice_occasions_sum,
                hadd_catch_i=hadd_catch_sum/n_choice_occasions_sum,
                cv_i=cv_sum/n_choice_occasions_sum) %>% 
  # dplyr::filter(decade %in% c("1", "3", "5", "7")) %>% 
  dplyr::arrange(month, decade, draw) %>% 
  dplyr::filter(closure_month==10)

plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=ntrips_alt_sum)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Number of trips", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

CV per choice occasion by month:

```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cv_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="CV per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Cod keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock keep per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_keep_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock keep per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2

```

<div style="margin-bottom:50px;">
</div>

Cod catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=cod_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Cod catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Haddock catch per choice occasion by month:
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=hadd_catch_i)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Haddock catch per choice occasion", label=comma) +
  facet_wrap(~month, nrow = 2)
plot2
```


<div style="margin-bottom:50px;">
</div>

Correlation in keep of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_keep_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in keep per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```
<div style="margin-bottom:50px;">
</div>

Correlation in catch of cod and haddock per choice occasion (kendall's tau-b):
```{r echo = FALSE}
plot2<-ggplot(predictions_data_month_d1, aes(x=decade, y=k_tau_catch_est_mnth)) + 
  geom_violin() + 
  #geom_boxplot(width=0.1)+
  scale_y_continuous(name="Correlation in catch per choice occasion", label=comma) + geom_hline(yintercept=0, linetype="dashed", color = "red")+
  facet_wrap(~month, nrow = 2)
plot2
```

### {-}